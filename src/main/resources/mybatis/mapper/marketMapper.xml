<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="market">

	<insert id="insertService" parameterType="MarketVO">
	<![CDATA[
		INSERT 
		  INTO MARKET
			   (
			    TYPE
			  , TITLE
			  , CONTENT
			  , REG_DATE
			  , LOCATION
			  , JM_STATE
			  , PRICE
			  , ID
			  , CATEGORY
			  , RV_STATE
			  , CH_STATE
			  , SV_STATE
			 )
		VALUES (
			    #{type}
			  , #{title}
			  , #{content}
			  , NOW()
			  , #{location}
			  , #{jmState}
			  , #{price}
			  , #{id}
			  , #{category}
			  , #{rvState}
			  , #{chState}
			  , #{svState}
			 )
	]]>
	</insert>
	
	<insert id="insertJm" parameterType="MarketVO">
		<![CDATA[
			INSERT 
			  INTO JMSTATE
				   (
				    JM_ID
				  , JM_SERVICE
				 )
			VALUES (
				    #{jmId}
				  , #{jmService}
				 )
		]]>
	</insert>
	
	<select id="selectJm" parameterType="MarketVO">
		<![CDATA[
			SELECT JM_ID
				 , JM_SERVICE
			  FROM JMSTATE
		 	 WHERE JM_ID = #{jmId}
		]]>
	
	</select>

	<select id="selectMarketList" parameterType="MarketVO" resultType="MarketVO">
		<![CDATA[
			SELECT SERVICE_NO
				 , CASE TYPE
			  	   WHEN 0 THEN '구매'
			  	   WHEN 1 THEN '판매'
			  	   END AS TYPE_NM
			 	 , TITLE
			 	 , CONTENT
				 , REG_DATE
				 , UPDATE_DATE
				 , LOCATION
				 , JM_STATE
				 , PRICE
				 , ID
				 , CATEGORY
				 , RV_STATE
				 , CH_STATE
				 , SV_STATE
			  FROM MARKET
		]]>
	</select>

	<select id="selectServiceDetail" parameterType="MarketVO" resultType="MarketVO">
		<![CDATA[
			SELECT SERVICE_NO
				 , CASE TYPE
			  	   WHEN 0 THEN '구매'
			  	   WHEN 1 THEN '판매'
			  	   END AS TYPE_NM
				 , TITLE
				 , CONTENT
				 , REG_DATE
				 , UPDATE_DATE
				 , LOCATION
				 , JM_STATE
				 , PRICE
				 , ID
				 , CATEGORY
				 , RV_STATE
				 , CH_STATE
				 , SV_STATE
		 	  FROM MARKET
			 WHERE SERVICE_NO = #{serviceNo}
		]]>
	</select>
	  
	<update id="serviceUpdate" parameterType="MarketVO">
		UPDATE MARKET
		   SET TYPE = #{type}
			 , TITLE = #{title}
			 , CONTENT = #{content}
			 , LOCATION = #{location}
			 , JM_STATE = #{jmState}
			 , PRICE = #{price}
			 , CATEGORY = #{category}
			 , RV_STATE = #{rvState}
			 , CH_STATE = #{chState}
			 , SV_STATE = #{svState}
			 , UPDATE_DATE = NOW()
		 WHERE SERVICE_NO = #{serviceNo}
	</update>
	
	<delete id="serviceDelete" parameterType="MarketVO">
		DELETE 
		  FROM MARKET
		 WHERE SERVICE_NO = #{serviceNo}
	</delete>
	
	<delete id="deleteJm" parameterType="MarketVO">
		<![CDATA[
			DELETE 
			  FROM JMSTATE
			 WHERE JM_ID = #{jmId}
		]]>
	</delete>
</mapper>